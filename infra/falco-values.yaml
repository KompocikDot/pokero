
json_output: true
stdout_output:
  enabled: true
syslog_output:
  enabled: false
file_output:
  enabled: false

falcosidekick:
  enabled: false

customRules:
  rules.yaml: |-
    - rule: Wykryj Django Debug Runserver
      desc: Ktos odpalil serwer developerski na produkcji
      condition: spawned_process and proc.cmdline contains "runserver"
      output: "SECURITY ALERT: Django Dev Server detected! (user=%user.name command=%proc.cmdline)"
      priority: WARNING
      tags: [app_soczek]

    - rule: Wykryj uzycie curl w kontenerze
      desc: Ktos pobiera cos z internetu wewnatrz kontenera
      condition: spawned_process and proc.name = curl
      output: "Suspicious network tool used: curl (user=%user.name container=%container.name)"
      priority: NOTICE
      tags: [network, mitre_discovery]

    - rule: Wykryj zapis w /etc
      desc: Proba modyfikacji plikow systemowych
      condition: open_write and fd.name startswith /etc/
      output: "System file modification attempt in /etc! (user=%user.name file=%fd.name)"
      priority: CRITICAL
      tags: [filesystem]
